name: Fetch sitemap

on:
  schedule:
    - cron: '0 * * * *'  # —Ä–∞–∑ –≤ —á–∞—Å
  workflow_dispatch:  # –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é –∏–∑ –≤–∫–ª–∞–¥–∫–∏ Actions

permissions:
  contents: write   # üëà –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ! –∏–Ω–∞—á–µ –Ω–µ —Å–º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å commit/push

jobs:
  fetch:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Download sitemap
        run: |
          curl -L https://salomon.community/sitemap.xml -o sitemap.xml

      - name: Commit & push sitemap
        run: |
          git config user.name "CacheBot"
          git config user.email "bot@example.com"
          git add sitemap.xml
          git commit -m "update sitemap $(date -u +'%Y-%m-%dT%H:%M:%SZ')" || echo "No changes"
          git push
